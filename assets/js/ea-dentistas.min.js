let map,marker,lat,lng,autocomplete;const allInfoWindows=[],markers={},itemsLista=Object.values(ajax_object.listagem),itemsDestaques=itemsLista.filter(e=>"on"===e.destaque),itensNaoDestaques=itemsLista.filter(e=>"on"!==e.destaque),todosDentistas=itemsLista;function removeAccents(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}lat=ajax_object.lat,lng=ajax_object.lng;const estadoUsuario=ajax_object.estado?removeAccents(ajax_object.estado.toUpperCase()):"",cidadeUsuario=ajax_object.cidade?removeAccents(ajax_object.cidade.toUpperCase()):"",cepUsuario=ajax_object.cep?ajax_object.cep.replace(/\D/g,""):"",bairroUsuario=ajax_object.bairro?removeAccents(ajax_object.bairro.toUpperCase()):"";function closeAllInfoWindows(){for(const e of allInfoWindows)e.close()}function btnClick(t,a){t.addEventListener("click",e=>{e.preventDefault(),closeAllInfoWindows();e=t.dataset.markerid;a.maps.event.trigger(markers[e],"click")})}function initGoogleApi(){document.addEventListener("DOMContentLoaded",function(){eaDentistasListagem(),initAutocomplete()})}function initMap(){var e,t=document.getElementById("map");t&&(lat,lat&&(lng,lng)||(lat="-23.5502909",lng="-46.6341887"),lat=Number(lat),lng=Number(lng),e={lat:lat,lng:lng},map=new google.maps.Map(t,{zoom:15,center:e,mapTypeControl:!1}),todosDentistas.forEach((e,t)=>{var a={lat:parseFloat(e.lat),lng:parseFloat(e.lng)};const n=`<div>
                <h5>${e.nome}</h5>
                <address>
                Endereço: ${e.endereco_completo}
                Telefone: ${e.telefone_contato}
                </address>
            </div>`,o=new google.maps.InfoWindow({content:n,ariaLabel:e.nome_fantasia});allInfoWindows.push(o);var r,a=new google.maps.Marker({position:a,map:map,title:e.nome_fantasia});google.maps.event.addListener(a,"click",(r=a,function(){closeAllInfoWindows(),o.setContent(n),o.open(map,r),map.setZoom(16),map.setCenter(r.getPosition())})),markers[e.post_id]=a}))}function initAutocomplete(){var e=document.getElementById("autocomplete");e&&(autocomplete=new google.maps.places.Autocomplete(e,{componentRestrictions:{country:["BR"]},fields:["place_id","geometry","name","address_components"]})).addListener("place_changed",onPlaceChanged)}function onPlaceChanged(){var e,t,a,n=autocomplete.getPlace(),o=document.querySelector(".ea-autocomplete-form"),r=o.querySelector('input[name="lat"]'),l=o.querySelector('input[name="lng"]'),s=o.querySelector('input[name="estado"]'),i=o.querySelector('input[name="cidade"]'),c=o.querySelector('input[name="cep"]'),u=o.querySelector('input[name="bairro"]');o?r?l?s&&i?c?u?n.geometry?(lat=n.geometry.location.lat(),lng=n.geometry.location.lng(),console.log("place.address_components",n.address_components),o=n.address_components.filter(e=>e.types.includes("administrative_area_level_1")),e=n.address_components.filter(e=>e.types.includes("administrative_area_level_2")),t=n.address_components.filter(e=>e.types.includes("postal_code")),a=n.address_components.filter(e=>e.types.includes("sublocality_level_1")),document.getElementById("autocomplete").innerHTML=n.name,r.value=lat,l.value=lng,s.value=o[0].short_name,i.value=e[0].short_name,c.value=t[0].short_name,u.value=a[0].short_name):(document.getElementById("autocomplete").placeholder="Digite um endereço",r.value="",l.value="",s.value="",i.value="",c.value="",u.value=""):console.error("Não foi possível encontrar o input de bairro"):console.error("Não foi possível encontrar o input de CEP"):console.error("Não foi possível encontrar o input de Estado"):console.error("Não foi possível encontrar o input de longitude"):console.error("Não foi possível encontrar o input de latitude"):console.error("Não foi possível encontrar o formulário do autocomplete")}function addPageNumbers(t,a,n,o,r){var l=Number(a.querySelector('input[name="current-page"]').value);for(let e=1;e<=n;e++){var s=document.createElement("li"),i=(s.classList.add("page-number"),l===e&&s.classList.add("current"),document.createElement("button"));i.innerText=e,i.dataset.pageIndex=e,s.append(i),t.append(s),changeCurrentPage(i,o,r,t,a)}}function setCurrentPage(e,t,a){var n=Number(t.querySelector('input[name="current-page"]').value)*a,o=n-a;let r=1;for(const l of e)r<=o||r>n?l.style.display="none":l.style.display="",r++}function changeCurrentPage(o,r,l,s,i){o.addEventListener("click",t=>{t.preventDefault();var t=i.querySelector('input[name="current-page"]'),a=Number(o.dataset.pageIndex),e=o.parentElement;if(e&&!e.classList.contains("current")){t.value=a;let e=1;for(const n of s.querySelectorAll(".page-number"))n.classList.remove("current"),e===a&&n.classList.add("current"),e++;setCurrentPage(r,i,l)}})}function eaPaginationPrevNext(e,t,a,n,o){e.addEventListener("click",e=>{e.preventDefault();var e=Number(o.querySelector('input[name="current-page"]').value),t=n.querySelectorAll(".page-number");e<=1||t[e-2].querySelector("button").click()}),t.addEventListener("click",e=>{e.preventDefault();var e=Number(o.querySelector('input[name="current-page"]').value),t=n.querySelectorAll(".page-number");t.length<=e||t[e].querySelector("button").click()})}function eaDentistasPagination(e){for(const l of document.querySelectorAll(".pagination-list")){var t=e.length,t=Math.ceil(t/10),a=l.parentElement.querySelector(".pagination-container");if(!a)return;var n=a.querySelector(".pagination-numbers");if(!n)return;var o=a.querySelector(".pagination-prev"),r=a.querySelector(".pagination-next");addPageNumbers(n,a,t,e,10),setCurrentPage(e,a,10),eaPaginationPrevNext(o,r,e,n,a)}}function eaDentistasGetGeolocation({lat:t,lng:a}){navigator.geolocation.getCurrentPosition(function(e){return t=e.coords.latitude,a=e.coords.longitude,{lat:t,lng:a}},function(e){console.log("Erro:",e)})}function eaDentistasListagem(){var e=document.getElementById("listagem-items");if(e){const t=new List("lista-dentistas",{valueNames:["nome","endereco_completo","telefone_contato","destaque","cep","bairro"],page:10,pagination:[{paginationClass:"pagination-top",innerWindow:2,outerWindow:2,item:"<li><a class='page'></a></li>"},{paginationClass:"pagination-bottom",innerWindow:2,outerWindow:2,item:"<li><a class='page'></a></li>"}],item:function(n){return`
        <li class="${"on"===n.destaque?"destaque":""}">
            <input class="cidade" type="hidden" />
            <input class="estado" type="hidden" />
            <input class="cep" type="hidden" />
            <input class="bairro" type="hidden" />
            <h3>${"on"===n.destaque?'<span class="icon-destaque"></span>':""}<span class="nome"></span></h3>
            <p class="endereco_completo"></p>
            <ul class="contatos">
                <li>${`<a class="link-telefone" href="tel:+55${n.telefone_contato}">${(()=>{var e=n.telefone_contato;let t="",a="";return a=11<=e.length?(t=e.slice(2,7),e.slice(7)):(t=e.slice(2,6),e.slice(6)),`(${e.slice(0,2)}) ${t}-`+a})()}</a>`}</li>
            </ul>
            <button class="listagem-item-btn" data-markerid="${n.post_id}">Visualizar</button>
        </li>`}},todosDentistas),a=(t.sort(["destaque"],{order:"desc"},{alphabet:"AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvXxYyZzÀàÁáÃãÂâÉéÈèÍíÓóÚúÇç"}),document.getElementById("pesquisar-por-cidade")),n=document.getElementById("pesquisar-por-estado"),o=document.getElementById("pesquisar-por-bairro");a.addEventListener("keyup",e=>{e=removeAccents(e.target.value);t.search(e,["cidade"]),n.value="",o.value=""}),n.addEventListener("keyup",e=>{e=removeAccents(e.target.value);t.search(e,["estado"]),a.value="",o.value=""}),o.addEventListener("keyup",e=>{e=removeAccents(e.target.value);t.search(e,["bairro"]),n.value="",a.value=""});for(const r of document.querySelectorAll(".listagem-item-btn"))btnClick(r,google);t.on("updated",e=>{for(const t of document.querySelectorAll(".listagem-item-btn"))btnClick(t,google)}),initMap()}}