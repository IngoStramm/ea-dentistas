let map,marker,lat,lng,autocomplete;const allInfoWindows=[],markers={},itemsLista=Object.values(ajax_object.listagem),itemsDestaques=itemsLista.filter(e=>"on"===e.destaque),itensNaoDestaques=itemsLista.filter(e=>"on"!==e.destaque),todosDentistas=itemsLista;function removeAccents(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}lat=ajax_object.lat,lng=ajax_object.lng;const estadoUsuario=ajax_object.estado?removeAccents(ajax_object.estado.toUpperCase()):"",cidadeUsuario=ajax_object.cidade?removeAccents(ajax_object.cidade.toUpperCase()):"",cepUsuario=ajax_object.cep?ajax_object.cep.replace(/\D/g,""):"",bairroUsuario=ajax_object.bairro?removeAccents(ajax_object.bairro.toUpperCase()):"";function closeAllInfoWindows(){for(const e of allInfoWindows)e.close()}function btnClick(t,o){t.addEventListener("click",e=>{e.preventDefault(),closeAllInfoWindows();e=t.dataset.markerid;o.maps.event.trigger(markers[e],"click")})}function initGoogleApi(){document.addEventListener("DOMContentLoaded",function(){eaDentistasListagem(),initAutocomplete()})}function initMap(){var e,t=document.getElementById("map");t&&(lat,lat&&(lng,lng)||(lat="-23.5502909",lng="-46.6341887"),lat=Number(lat),lng=Number(lng),e={lat:lat,lng:lng},map=new google.maps.Map(t,{zoom:15,center:e,mapTypeControl:!1}),todosDentistas.forEach((e,t)=>{var o={lat:parseFloat(e.lat),lng:parseFloat(e.lng)};const a=`<div>
                <h5>${e.nome}</h5>
                <address>
                Endereço: ${e.endereco_completo}
                Telefone: ${e.telefone_contato}
                </address>
            </div>`,n=new google.maps.InfoWindow({content:a,ariaLabel:e.nome_fantasia});allInfoWindows.push(n);var r,o=new google.maps.Marker({position:o,map:map,title:e.nome_fantasia});google.maps.event.addListener(o,"click",(r=o,function(){closeAllInfoWindows(),n.setContent(a),n.open(map,r),map.setZoom(16),map.setCenter(r.getPosition())})),markers[e.post_id]=o}))}function initAutocomplete(){var e=document.getElementById("autocomplete");e&&(autocomplete=new google.maps.places.Autocomplete(e,{componentRestrictions:{country:["BR"]},fields:["place_id","geometry","name","address_components"]})).addListener("place_changed",onPlaceChanged)}function onPlaceChanged(){var e,t,o,a=autocomplete.getPlace(),n=document.querySelector(".ea-autocomplete-form"),r=n.querySelector('input[name="lat"]'),l=n.querySelector('input[name="lng"]'),s=n.querySelector('input[name="estado"]'),i=n.querySelector('input[name="cidade"]'),c=n.querySelector('input[name="cep"]'),u=n.querySelector('input[name="bairro"]');n?r?l?s&&i?c?u?a.geometry?(lat=a.geometry.location.lat(),lng=a.geometry.location.lng(),console.log("place.address_components",a.address_components),n=a.address_components.filter(e=>e.types.includes("administrative_area_level_1")),e=a.address_components.filter(e=>e.types.includes("administrative_area_level_2")),t=a.address_components.filter(e=>e.types.includes("postal_code")),o=a.address_components.filter(e=>e.types.includes("sublocality_level_1")),document.getElementById("autocomplete").innerHTML=a.name,r.value=lat,l.value=lng,s.value=n[0]?.short_name,i.value=e[0]?.short_name,c.value=t[0]?.short_name,u.value=o[0]?.short_name,console.log("stateInput.value: ",s.value)):(document.getElementById("autocomplete").placeholder="Digite um endereço",r.value="",l.value="",s.value="",i.value="",c.value="",u.value=""):console.error("Não foi possível encontrar o input de bairro"):console.error("Não foi possível encontrar o input de CEP"):console.error("Não foi possível encontrar o input de Estado"):console.error("Não foi possível encontrar o input de longitude"):console.error("Não foi possível encontrar o input de latitude"):console.error("Não foi possível encontrar o formulário do autocomplete")}function addPageNumbers(t,o,a,n,r){var l=Number(o.querySelector('input[name="current-page"]').value);for(let e=1;e<=a;e++){var s=document.createElement("li"),i=(s.classList.add("page-number"),l===e&&s.classList.add("current"),document.createElement("button"));i.innerText=e,i.dataset.pageIndex=e,s.append(i),t.append(s),changeCurrentPage(i,n,r,t,o)}}function setCurrentPage(e,t,o){var a=Number(t.querySelector('input[name="current-page"]').value)*o,n=a-o;let r=1;for(const l of e)r<=n||r>a?l.style.display="none":l.style.display="",r++}function changeCurrentPage(n,r,l,s,i){n.addEventListener("click",t=>{t.preventDefault();var t=i.querySelector('input[name="current-page"]'),o=Number(n.dataset.pageIndex),e=n.parentElement;if(e&&!e.classList.contains("current")){t.value=o;let e=1;for(const a of s.querySelectorAll(".page-number"))a.classList.remove("current"),e===o&&a.classList.add("current"),e++;setCurrentPage(r,i,l)}})}function eaPaginationPrevNext(e,t,o,a,n){e.addEventListener("click",e=>{e.preventDefault();var e=Number(n.querySelector('input[name="current-page"]').value),t=a.querySelectorAll(".page-number");e<=1||t[e-2].querySelector("button").click()}),t.addEventListener("click",e=>{e.preventDefault();var e=Number(n.querySelector('input[name="current-page"]').value),t=a.querySelectorAll(".page-number");t.length<=e||t[e].querySelector("button").click()})}function eaDentistasPagination(e){for(const l of document.querySelectorAll(".pagination-list")){var t=e.length,t=Math.ceil(t/10),o=l.parentElement.querySelector(".pagination-container");if(!o)return;var a=o.querySelector(".pagination-numbers");if(!a)return;var n=o.querySelector(".pagination-prev"),r=o.querySelector(".pagination-next");addPageNumbers(a,o,t,e,10),setCurrentPage(e,o,10),eaPaginationPrevNext(n,r,e,a,o)}}function eaDentistasGetGeolocation({lat:t,lng:o}){navigator.geolocation.getCurrentPosition(function(e){return t=e.coords.latitude,o=e.coords.longitude,{lat:t,lng:o}},function(e){console.log("Erro:",e)})}function eaDentistasListagem(){var e=document.getElementById("listagem-items");if(e){e=new List("lista-dentistas",{valueNames:["nome","endereco_completo","telefone_contato","destaque","cep","bairro"],page:10,pagination:[{paginationClass:"pagination-top",innerWindow:2,outerWindow:2,item:"<li><a class='page'></a></li>"},{paginationClass:"pagination-bottom",innerWindow:2,outerWindow:2,item:"<li><a class='page'></a></li>"}],item:function(a){return`
        <li class="${"on"===a.destaque?"destaque":""}">
            <input class="cidade" type="hidden" />
            <input class="estado" type="hidden" />
            <input class="cep" type="hidden" />
            <input class="bairro" type="hidden" />
            <h3>${"on"===a.destaque?'<span class="icon-destaque"></span>':""}<span class="nome"></span></h3>
            <p class="endereco_completo"></p>
            <ul class="contatos">
                <li>${`<a class="link-telefone" href="tel:+55${a.telefone_contato}">${(()=>{var e=a.telefone_contato;let t="",o="";return o=11<=e.length?(t=e.slice(2,7),e.slice(7)):(t=e.slice(2,6),e.slice(6)),`(${e.slice(0,2)}) ${t}-`+o})()}</a>`}</li>
            </ul>
            <button class="listagem-item-btn" data-markerid="${a.post_id}">Visualizar</button>
        </li>`}},todosDentistas);e.sort(["destaque"],{order:"desc"},{alphabet:"AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvXxYyZzÀàÁáÃãÂâÉéÈèÍíÓóÚúÇç"}),document.getElementById("pesquisar-por-cidade"),document.getElementById("pesquisar-por-estado"),document.getElementById("pesquisar-por-bairro");for(const t of document.querySelectorAll(".listagem-item-btn"))btnClick(t,google);e.on("updated",e=>{for(const t of document.querySelectorAll(".listagem-item-btn"))btnClick(t,google)}),initMap()}}