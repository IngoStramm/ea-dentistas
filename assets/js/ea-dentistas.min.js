let map,marker,lat,lng,autocomplete;const allInfoWindows=[],markers={},itemsLista=Object.values(ajax_object.listagem),itemsDestaques=itemsLista.filter(e=>"on"===e.destaque),itensNaoDestaques=itemsLista.filter(e=>"on"!==e.destaque),todosDentistas=itemsDestaques.concat(itensNaoDestaques);function removeAccents(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}console.log("todosDentistas",todosDentistas),lat=ajax_object.lat,lng=ajax_object.lng;const estadoUsuario=ajax_object.estado?removeAccents(ajax_object.estado.toUpperCase()):"",cidadeUsuario=ajax_object.cidade?removeAccents(ajax_object.cidade.toUpperCase()):"";function closeAllInfoWindows(){for(const e of allInfoWindows)e.close()}function btnClick(t,o){t.addEventListener("click",e=>{e.preventDefault(),closeAllInfoWindows();e=t.dataset.markerid;console.log("markerid",e),o.maps.event.trigger(markers[e],"click")})}function initGoogleApi(){document.addEventListener("DOMContentLoaded",function(){eaDentistasListagem(),initAutocomplete()})}function initMap(){var e,t=document.getElementById("map");t&&(lat,lat&&(lng,lng)||(lat="-23.5502909",lng="-46.6341887"),lat=Number(lat),lng=Number(lng),e={lat:lat,lng:lng},console.log("2 - lat",lat),console.log("2 - lng",lng),map=new google.maps.Map(t,{zoom:15,center:e,mapTypeControl:!1}),todosDentistas.forEach((e,t)=>{var o={lat:parseFloat(e.lat),lng:parseFloat(e.lng)};const a=`<div>
                <h5>${e.nome}</h5>
                <address>
                Endereço: ${e.endereco_completo}
                Telefone: ${e.telefone_contato}
                </address>
            </div>`,n=new google.maps.InfoWindow({content:a,ariaLabel:e.nome_fantasia});allInfoWindows.push(n);var l,o=new google.maps.Marker({position:o,map:map,title:e.nome_fantasia});google.maps.event.addListener(o,"click",(l=o,function(){n.setContent(a),n.open(map,l)})),markers[e.post_id]=o}))}function initAutocomplete(){var e=document.getElementById("autocomplete");e&&(autocomplete=new google.maps.places.Autocomplete(e,{componentRestrictions:{country:["BR"]},fields:["place_id","geometry","name","address_components"]})).addListener("place_changed",onPlaceChanged)}function onPlaceChanged(){var e,t=autocomplete.getPlace(),o=document.querySelector(".ea-autocomplete-form"),a=o.querySelector('input[name="lat"]'),n=o.querySelector('input[name="lng"]'),l=o.querySelector('input[name="estado"]'),r=o.querySelector('input[name="cidade"]');o?a?n?l&&r?t.geometry?(lat=t.geometry.location.lat(),lng=t.geometry.location.lng(),console.log("lat",lat),console.log("lng",lng),o=t.address_components.filter(e=>e.types.includes("administrative_area_level_1")),e=t.address_components.filter(e=>e.types.includes("administrative_area_level_2")),console.log("estado",o[0].short_name),console.log("cidade",e[0].short_name),document.getElementById("autocomplete").innerHTML=t.name,a.value=lat,n.value=lng,l.value=o[0].short_name,r.value=e[0].short_name):(document.getElementById("autocomplete").placeholder="Digite um endereço",a.value="",n.value="",l.value="",r.value=""):console.error("Não foi possível encontrar o input de Estado"):console.error("Não foi possível encontrar o input de longitude"):console.error("Não foi possível encontrar o input de latitude"):console.error("Não foi possível encontrar o formulário do autocomplete")}function addPageNumbers(t,o,a,n,l){var r=Number(o.querySelector('input[name="current-page"]').value);for(let e=1;e<=a;e++){var s=document.createElement("li"),i=(s.classList.add("page-number"),r===e&&s.classList.add("current"),document.createElement("button"));i.innerText=e,i.dataset.pageIndex=e,s.append(i),t.append(s),changeCurrentPage(i,n,l,t,o)}}function setCurrentPage(e,t,o){var a=Number(t.querySelector('input[name="current-page"]').value)*o,n=a-o;let l=1;for(const r of e)l<=n||l>a?r.style.display="none":r.style.display="",l++}function changeCurrentPage(n,l,r,s,i){n.addEventListener("click",t=>{t.preventDefault();var t=i.querySelector('input[name="current-page"]'),o=Number(n.dataset.pageIndex),e=n.parentElement;if(e&&!e.classList.contains("current")){t.value=o;let e=1;for(const a of s.querySelectorAll(".page-number"))a.classList.remove("current"),e===o&&a.classList.add("current"),e++;setCurrentPage(l,i,r)}})}function eaPaginationPrevNext(e,t,o,a,n){e.addEventListener("click",e=>{e.preventDefault();var e=Number(n.querySelector('input[name="current-page"]').value),t=a.querySelectorAll(".page-number");e<=1||t[e-2].querySelector("button").click()}),t.addEventListener("click",e=>{e.preventDefault();var e=Number(n.querySelector('input[name="current-page"]').value),t=a.querySelectorAll(".page-number");t.length<=e||t[e].querySelector("button").click()})}function eaDentistasPagination(e){for(const r of document.querySelectorAll(".pagination-list")){var t=e.length,t=(console.log("totalItems",t),Math.ceil(t/10)),o=r.parentElement.querySelector(".pagination-container");if(!o)return;var a=o.querySelector(".pagination-numbers");if(!a)return;var n=o.querySelector(".pagination-prev"),l=o.querySelector(".pagination-next");addPageNumbers(a,o,t,e,10),setCurrentPage(e,o,10),eaPaginationPrevNext(n,l,e,a,o)}}function eaDentistasGetGeolocation({lat:t,lng:o}){navigator.geolocation.getCurrentPosition(function(e){return console.log("Deu certo!"),t=e.coords.latitude,o=e.coords.longitude,console.log("1 - lat",t),console.log("1 - lng",o),{lat:t,lng:o}},function(e){console.log("Deu erro",e)})}function eaDentistasListagem(){var e=document.getElementById("listagem-items");if(e){const t=new List("lista-dentistas",{valueNames:["nome","endereco_completo","telefone_contato","destaque",{name:"post_id",attr:"data-markerid"}],page:5,pagination:!0,item:`
        <li>
            <input class="destaque" type="hidden" />
            <input class="cidade" type="hidden" />
            <input class="estado" type="hidden" />
            <h3 class="nome"></h3>
            <p class="endereco_completo"></p>
            <ul>
                <li class="telefone_contato"></li>
                <button class="listagem-item-btn post_id">Visualizar</button>
            </ul>
        </li>`},todosDentistas),o=(t.sort("nome",{alphabet:"AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvXxYyZzÀàÁáÃãÂâÉéÈèÍíÓóÚúÇç"}),t.sort(["destaque"],{order:"desc"},{alphabet:"AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvXxYyZzÀàÁáÃãÂâÉéÈèÍíÓóÚúÇç"}),cidadeUsuario&&(t.search(cidadeUsuario,["cidade"]),e=document.getElementById("pesquisar-por-cidade"))&&(e.value=cidadeUsuario),document.getElementById("pesquisar-por-cidade")),a=document.getElementById("pesquisar-por-estado");o.addEventListener("keyup",e=>{e=removeAccents(e.target.value);t.search(e,["cidade"]),a.value=""}),a.addEventListener("keyup",e=>{e=removeAccents(e.target.value);t.search(e,["estado"]),o.value=""});for(const n of document.querySelectorAll(".listagem-item-btn"))btnClick(n,google);t.on("updated",e=>{for(const t of document.querySelectorAll(".listagem-item-btn"))btnClick(t,google)}),initMap()}}console.log("estadoUsuario",estadoUsuario),console.log("cidadeUsuario",cidadeUsuario);